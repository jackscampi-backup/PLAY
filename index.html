<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRUMMER - Beat Generator per Bassisti</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="rack-wrapper">
    <div class="rack-container">
    <!-- DRUMMER Unit -->
    <div class="rack-unit rack-main">
        <!-- Viti angolari -->
        <div class="rack-screw top-left"></div>
        <div class="rack-screw top-right"></div>
        <div class="rack-screw bottom-left"></div>
        <div class="rack-screw bottom-right"></div>

        <!-- Header Panel -->
        <header class="rack-header">
            <div class="header-toggles-left">
                <button class="display-toggle" id="beatPlayBtn">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ON</span>
                </button>
            </div>
            <div class="logo-display">DRUMMER</div>
            <div class="bar-indicator" id="barIndicator">
                <!-- Populated dynamically for multi-bar patterns -->
            </div>
        </header>

        <!-- Main Panel -->
        <main class="rack-panel">

            <!-- Genre Section -->
            <section class="panel-section">
                <div class="section-label">GENRE</div>
                <div class="button-grid" id="genreButtons">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- Pattern Section -->
            <section class="panel-section">
                <div class="section-label">PATTERN</div>
                <div class="button-grid" id="variationButtons">
                    <!-- Populated by JS -->
                </div>
            </section>


            <!-- Pattern Display -->
            <section class="pattern-section">
                <div class="pattern-grid">
                    <!-- Beat Counter Row -->
                    <div class="beat-row">
                        <div class="beat-group">
                            <span class="beat-num" data-beat="1">1</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                        </div>
                        <div class="beat-group">
                            <span class="beat-num" data-beat="2">2</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                        </div>
                        <div class="beat-group">
                            <span class="beat-num" data-beat="3">3</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                        </div>
                        <div class="beat-group">
                            <span class="beat-num" data-beat="4">4</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                        </div>
                    </div>

                    <!-- Kick Row -->
                    <div class="step-row" id="kickPattern"></div>

                    <!-- Snare Row -->
                    <div class="step-row" id="snarePattern"></div>

                    <!-- Hi-Hat Row -->
                    <div class="step-row" id="hihatPattern"></div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="rack-footer">
            <span class="footer-text">SPACE = PLAY/STOP</span>
        </footer>
    </div>

    <!-- AUDIO Panel Unit -->
    <div class="rack-unit rack-audio">
        <!-- Viti angolari -->
        <div class="rack-screw top-left"></div>
        <div class="rack-screw top-right"></div>
        <div class="rack-screw bottom-left"></div>
        <div class="rack-screw bottom-right"></div>

        <!-- Header -->
        <header class="rack-header">
            <div class="logo-display">AUDIO</div>
        </header>

        <!-- Main Panel -->
        <main class="rack-panel audio-panel">

            <!-- Master Section -->
            <section class="panel-section audio-section">
                <div class="section-label">MASTER</div>
                <div class="audio-control">
                    <span class="control-name">Auto</span>
                    <button class="auto-btn" id="autoModeBtn">
                        <span class="auto-led"></span>
                        <span class="auto-label">AUTO</span>
                    </button>
                </div>
                <div class="audio-control">
                    <span class="control-name">Bpm</span>
                    <div class="bpm-control">
                        <button class="bpm-btn" id="bpmMinus">-</button>
                        <input type="text" class="bpm-input" id="bpmDisplay" value="120" maxlength="3">
                        <button class="bpm-btn" id="bpmPlus">+</button>
                    </div>
                </div>
                <div class="audio-control">
                    <span class="control-name">Vol</span>
                    <input type="range" class="audio-slider" id="masterVolume" min="0" max="100" value="80">
                </div>
            </section>

            <!-- Kick Section -->
            <section class="panel-section audio-section instrument-row">
                <span class="instrument-label">KICK</span>
                <select class="audio-select" id="kickType">
                    <option value="deep">Deep</option>
                    <option value="punchy">Punchy</option>
                    <option value="808">808</option>
                    <option value="acoustic">Acoustic</option>
                </select>
                <input type="range" class="audio-slider" id="kickVolume" min="0" max="100" value="70">
            </section>

            <!-- Snare Section -->
            <section class="panel-section audio-section instrument-row">
                <span class="instrument-label">SNARE</span>
                <select class="audio-select" id="snareType">
                    <option value="tight">Tight</option>
                    <option value="fat">Fat</option>
                    <option value="rim">Rim</option>
                    <option value="clap">Clap</option>
                </select>
                <input type="range" class="audio-slider" id="snareVolume" min="0" max="100" value="70">
            </section>

            <!-- Hi-Hat Section -->
            <section class="panel-section audio-section instrument-row">
                <span class="instrument-label">HI-HAT</span>
                <select class="audio-select" id="hihatType">
                    <option value="closed">Closed</option>
                    <option value="open">Open</option>
                    <option value="shaker">Shaker</option>
                    <option value="ride">Ride</option>
                </select>
                <input type="range" class="audio-slider" id="hihatVolume" min="0" max="100" value="60">
            </section>

            <!-- Vinyl Section -->
            <section class="panel-section audio-section">
                <div class="audio-control">
                    <span class="control-name">Vinyl</span>
                    <input type="range" class="audio-slider" id="vinylAmount" min="0" max="100" value="0">
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="rack-footer">
            <span class="footer-text">SOUND CONTROL</span>
        </footer>
    </div>
    </div><!-- /rack-container -->

    <!-- MELODY Unit -->
    <div class="rack-unit rack-melody">
        <!-- Viti angolari -->
        <div class="rack-screw top-left"></div>
        <div class="rack-screw top-right"></div>
        <div class="rack-screw bottom-left"></div>
        <div class="rack-screw bottom-right"></div>

        <!-- Header -->
        <header class="rack-header">
            <div class="header-toggles-left">
                <button class="display-toggle" id="melodyPlayBtn">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ON</span>
                </button>
            </div>
            <div class="logo-display">MELODY</div>
            <div class="header-toggles-right">
                <button class="display-toggle" id="melodyNotationToggle">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ITA</span>
                </button>
            </div>
        </header>

        <!-- Main Panel -->
        <main class="rack-panel melody-panel">

            <!-- Row 1: KEY -->
            <section class="panel-section">
                <div class="section-label">KEY</div>
                <div class="button-grid key-grid" id="melodyKeyButtons">
                    <button class="root-btn" data-key="E">E</button>
                    <button class="root-btn" data-key="F">F</button>
                    <button class="root-btn" data-key="F#">F#</button>
                    <button class="root-btn" data-key="G">G</button>
                    <button class="root-btn" data-key="G#">G#</button>
                    <button class="root-btn" data-key="A">A</button>
                    <button class="root-btn" data-key="A#">A#</button>
                    <button class="root-btn" data-key="B">B</button>
                    <button class="root-btn" data-key="C">C</button>
                    <button class="root-btn" data-key="C#">C#</button>
                    <button class="root-btn" data-key="D">D</button>
                    <button class="root-btn" data-key="D#">D#</button>
                </div>
            </section>

            <!-- Row 2: MODE + PATTERN dropdown + NEXT -->
            <section class="panel-section melody-row">
                <div class="melody-control-group">
                    <div class="section-label">MODE</div>
                    <div class="mode-toggle-compact">
                        <button class="display-toggle" id="melodyChordsBtn">
                            <span class="toggle-led"></span>
                            <span class="toggle-label">CHORDS</span>
                        </button>
                        <button class="display-toggle" id="melodyMelodyBtn">
                            <span class="toggle-led"></span>
                            <span class="toggle-label">MELODY</span>
                        </button>
                    </div>
                </div>
                <div class="melody-control-group melody-pattern-group">
                    <div class="section-label">PATTERN</div>
                    <select class="groove-select-full" id="melodyPatternSelect">
                        <option value="">-- Select --</option>
                    </select>
                </div>
                <div class="melody-control-group">
                    <div class="section-label">&nbsp;</div>
                    <div class="melody-action-btns">
                        <button class="display-toggle melody-next-btn" id="melodyNextBtn">
                            <span class="toggle-led"></span>
                            <span class="toggle-label">NEXT</span>
                        </button>
                        <button class="display-toggle melody-save-btn" id="melodySaveBtn">
                            <span class="toggle-led"></span>
                            <span class="toggle-label">SAVE</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Saved Melodies (hidden until there are saved melodies) -->
            <section class="panel-section" id="savedMelodiesSection" style="display: none;">
                <div class="section-label">SAVED</div>
                <div class="saved-melodies-list" id="savedMelodiesList">
                    <!-- Populated dynamically -->
                </div>
            </section>

            <!-- Row 3: SOUND + VOLUME -->
            <section class="panel-section melody-row">
                <div class="melody-control-group">
                    <div class="section-label">SOUND</div>
                    <select class="audio-select" id="melodySoundSelect">
                        <option value="piano">PIANO</option>
                        <option value="organ">ORGAN</option>
                    </select>
                </div>
                <div class="melody-control-group melody-vol-group">
                    <div class="section-label">VOL</div>
                    <input type="range" class="audio-slider" id="melodyVolume" min="0" max="100" value="70">
                </div>
            </section>

            <!-- Row 4: Melody Timeline (only visible in melody mode) -->
            <section class="panel-section" id="melodyTimelineSection" style="display: none;">
                <div class="melody-timeline" id="melodyTimeline">
                    <!-- Populated dynamically with note boxes -->
                </div>
            </section>

            <!-- Row 5: Chord Strip (progression at a glance) -->
            <section class="panel-section">
                <div class="chord-strip" id="chordStrip">
                    <!-- Populated by JS: shows all chords in progression -->
                </div>
            </section>

            <!-- Row 6: Display + Mini Fretboard -->
            <section class="panel-section">
                <div class="melody-display-row">
                    <!-- Chord Display -->
                    <div class="chord-display" id="chordDisplay">
                        <div class="chord-name" id="chordName">—</div>
                        <div class="chord-notes" id="chordNotes">Select a pattern</div>
                    </div>

                    <!-- Mini Fretboard -->
                    <div class="mini-fretboard" id="miniFretboard">
                        <div class="mini-string" data-string="G">
                            <span class="mini-string-label">G</span>
                            <div class="mini-frets">
                                <div class="mini-fret mini-nut" data-fret="0"></div>
                                <div class="mini-fret" data-fret="1"></div>
                                <div class="mini-fret" data-fret="2"></div>
                                <div class="mini-fret marker" data-fret="3"></div>
                                <div class="mini-fret" data-fret="4"></div>
                                <div class="mini-fret marker" data-fret="5"></div>
                                <div class="mini-fret" data-fret="6"></div>
                            </div>
                        </div>
                        <div class="mini-string" data-string="D">
                            <span class="mini-string-label">D</span>
                            <div class="mini-frets">
                                <div class="mini-fret mini-nut" data-fret="0"></div>
                                <div class="mini-fret" data-fret="1"></div>
                                <div class="mini-fret" data-fret="2"></div>
                                <div class="mini-fret marker" data-fret="3"></div>
                                <div class="mini-fret" data-fret="4"></div>
                                <div class="mini-fret marker" data-fret="5"></div>
                                <div class="mini-fret" data-fret="6"></div>
                            </div>
                        </div>
                        <div class="mini-string" data-string="A">
                            <span class="mini-string-label">A</span>
                            <div class="mini-frets">
                                <div class="mini-fret mini-nut" data-fret="0"></div>
                                <div class="mini-fret" data-fret="1"></div>
                                <div class="mini-fret" data-fret="2"></div>
                                <div class="mini-fret marker" data-fret="3"></div>
                                <div class="mini-fret" data-fret="4"></div>
                                <div class="mini-fret marker" data-fret="5"></div>
                                <div class="mini-fret" data-fret="6"></div>
                            </div>
                        </div>
                        <div class="mini-string" data-string="E">
                            <span class="mini-string-label">E</span>
                            <div class="mini-frets">
                                <div class="mini-fret mini-nut" data-fret="0"></div>
                                <div class="mini-fret" data-fret="1"></div>
                                <div class="mini-fret" data-fret="2"></div>
                                <div class="mini-fret marker" data-fret="3"></div>
                                <div class="mini-fret" data-fret="4"></div>
                                <div class="mini-fret marker" data-fret="5"></div>
                                <div class="mini-fret" data-fret="6"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Row 6: Beat Indicator + Octave Control (same as DRUMMER/BASS) -->
            <section class="panel-section melody-bottom-section">
                <div class="melody-bottom-layout">
                    <!-- Beat Pattern Grid (same structure as DRUMMER) -->
                    <div class="melody-pattern-section" id="melodyPatternSection">
                        <div class="pattern-grid">
                            <!-- Beat Counter Row -->
                            <div class="beat-row">
                                <div class="beat-group">
                                    <span class="beat-num" data-beat="1">1</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                </div>
                                <div class="beat-group">
                                    <span class="beat-num" data-beat="2">2</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                </div>
                                <div class="beat-group">
                                    <span class="beat-num" data-beat="3">3</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                </div>
                                <div class="beat-group">
                                    <span class="beat-num" data-beat="4">4</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                </div>
                            </div>
                            <!-- Step Row -->
                            <div class="step-row" id="melodyStepRow">
                                <!-- Populated by JS - 16 steps like DRUMMER -->
                            </div>
                        </div>
                    </div>
                    <!-- Octave Control Box -->
                    <div class="melody-control-box">
                        <div class="melody-octave-control">
                            <button class="bpm-btn" id="melodyOctMinus">-</button>
                            <span class="octave-display" id="melodyOctDisplay">3</span>
                            <button class="bpm-btn" id="melodyOctPlus">+</button>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="rack-footer">
            <span class="footer-text">HARMONIC ACCOMPANIMENT</span>
        </footer>
    </div>

    <!-- BASSIST Unit -->
    <div class="rack-unit rack-bassist">
        <!-- Viti angolari -->
        <div class="rack-screw top-left"></div>
        <div class="rack-screw top-right"></div>
        <div class="rack-screw bottom-left"></div>
        <div class="rack-screw bottom-right"></div>

        <!-- Header -->
        <header class="rack-header">
            <div class="header-toggles-left">
                <button class="display-toggle" id="scalePlayBtn" onclick="fretboard.togglePlay()">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ON</span>
                </button>
            </div>
            <div class="logo-display">BASS</div>
            <div class="header-toggles-right">
                <button class="display-toggle" id="notationToggle" onclick="fretboard.toggleNotation()">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ITA</span>
                </button>
            </div>
        </header>

        <!-- Main Panel -->
        <main class="rack-panel bassist-panel">
            <!-- Root Note Selection -->
            <section class="panel-section">
                <div class="section-label">ROOT</div>
                <div class="button-grid root-grid" id="rootButtons">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- Scale Selection -->
            <section class="panel-section">
                <div class="section-label">SCALE</div>
                <div class="button-grid scale-grid" id="scaleButtons">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- View Toggles -->
            <section class="panel-section">
                <div class="section-label">VIEW</div>
                <div class="button-grid view-grid-5">
                    <button class="display-toggle" id="arpToggle" onclick="fretboard.toggleArpeggio()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">ARP</span>
                    </button>
                    <button class="display-toggle" id="shapeToggle" onclick="fretboard.toggleShape()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">BOX</span>
                    </button>
                    <button class="display-toggle" id="displayToggle" onclick="fretboard.toggleDisplay()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">INT</span>
                    </button>
                    <button class="display-toggle" id="grooveToggle" onclick="fretboard.toggleGrooveMode()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">GROOVE</span>
                    </button>
                    <button class="display-toggle" id="melodyToggle" onclick="fretboard.toggleMelodySync()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">MEL</span>
                    </button>
                </div>
            </section>

            <!-- Grooves Selection -->
            <section class="panel-section groove-section">
                <div class="section-label">GROOVES</div>
                <div class="groove-categories" id="grooveCategories">
                    <!-- Populated by JS -->
                </div>
                <select class="audio-select groove-select-full" id="grooveSelect" onchange="fretboard.selectGroove(this.value)">
                    <option value="">-- Select --</option>
                </select>
            </section>

            <!-- MEL Mode Chord Strip (only visible in MEL mode) - same style as MELODY -->
            <section class="panel-section mel-chord-section" id="melChordSection" style="display: none;">
                <div class="chord-strip" id="bassChordStrip">
                    <!-- Populated by JS: shows chord progression like MELODY -->
                </div>
            </section>

            <!-- Fretboard -->
            <section class="panel-section fretboard-section">
                <div id="fretboard" class="fretboard">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- Groove Pattern Display (under fretboard) -->
            <section class="panel-section bassist-bottom-section">
                <div class="bassist-bottom-layout">
                    <!-- Pattern Grid (same as DRUMMER) -->
                    <div class="bass-pattern-section" id="groovePatternDisplay">
                        <div class="pattern-grid">
                            <!-- Beat Counter Row -->
                            <div class="beat-row">
                                <div class="beat-group">
                                    <span class="beat-num" data-beat="1">1</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                </div>
                                <div class="beat-group">
                                    <span class="beat-num" data-beat="2">2</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                </div>
                                <div class="beat-group">
                                    <span class="beat-num" data-beat="3">3</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                </div>
                                <div class="beat-group">
                                    <span class="beat-num" data-beat="4">4</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                    <span class="beat-dot">·</span>
                                </div>
                            </div>
                            <!-- Bass Step Row -->
                            <div class="step-row" id="grooveStepRow">
                                <!-- Populated by JS - 16 steps -->
                            </div>
                        </div>
                    </div>
                    <!-- Control Box (right side) -->
                    <div class="bassist-control-box">
                        <div class="bassist-bpm-control">
                            <button class="bpm-btn" id="bassBpmMinus">-</button>
                            <span class="bpm-display" id="bassBpmDisplay">120</span>
                            <button class="bpm-btn" id="bassBpmPlus">+</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="rack-footer">
            <span class="footer-text">4-STRING BASS FRETBOARD</span>
        </footer>
    </div>

    </div><!-- /rack-wrapper -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="js/patterns.js"></script>
    <script src="js/scales.js"></script>
    <script src="js/sounds.js"></script>
    <script src="js/riffs.js"></script>
    <script src="js/beatgen.js"></script>
    <script src="js/fretboard.js?v=2"></script>

    <!-- MELODY PATTERNS INLINE -->
    <script>
    console.log('Loading melody patterns inline...');
    window.NOTES = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
    const NOTES = window.NOTES;
    const CHORD_QUALITIES = {
        'maj': [0, 4, 7], 'min': [0, 3, 7], 'dom7': [0, 4, 7, 10], 'maj7': [0, 4, 7, 11],
        'min7': [0, 3, 7, 10], 'dim': [0, 3, 6], 'aug': [0, 4, 8], 'sus4': [0, 5, 7], 'sus2': [0, 2, 7]
    };
    const SCALE_DEGREES = {
        'I': 0, 'bII': 1, 'II': 2, 'bIII': 3, 'III': 4, 'IV': 5, '#IV': 6, 'bV': 6,
        'V': 7, 'bVI': 8, 'VI': 9, 'bVII': 10, 'VII': 11
    };
    const SCALES = {
        'major': {intervals: [0, 2, 4, 5, 7, 9, 11]},
        'minor': {intervals: [0, 2, 3, 5, 7, 8, 10]},
        'minor_pentatonic': {intervals: [0, 3, 5, 7, 10]}
    };
    window.getChordNotes = function(degree, quality, key, octave = 3) {
        const keyIndex = NOTES.indexOf(key);
        const degreeOffset = SCALE_DEGREES[degree] || 0;
        const rootIndex = (keyIndex + degreeOffset) % 12;
        const intervals = CHORD_QUALITIES[quality] || [0, 4, 7];
        return intervals.map(interval => {
            const noteIndex = (rootIndex + interval) % 12;
            const noteOctave = octave + Math.floor((rootIndex + interval) / 12);
            return NOTES[noteIndex] + noteOctave;
        });
    }
    window.getMelodyNote = function(degree, key, octave = 4, scale = 'major') {
        const keyIndex = NOTES.indexOf(key);
        const scaleIntervals = SCALES[scale]?.intervals || [0, 2, 4, 5, 7, 9, 11];
        const degreeIndex = (degree - 1) % scaleIntervals.length;
        const interval = scaleIntervals[degreeIndex];
        const noteIndex = (keyIndex + interval) % 12;
        const noteOctave = octave + Math.floor((keyIndex + interval) / 12);
        return NOTES[noteIndex] + noteOctave;
    }
    window.CHORD_PROGRESSIONS = [
        {id: 'rock-i-iv-v', name: 'I-IV-V (Rock)', type: 'chords', genre: 'rock', key: 'C', bars: 4,
         steps: [{degree: 'I', quality: 'maj', beat: 0, duration: 4}, {degree: 'IV', quality: 'maj', beat: 0, duration: 4}, {degree: 'V', quality: 'maj', beat: 0, duration: 2}, {degree: 'IV', quality: 'maj', beat: 2, duration: 2}, {degree: 'I', quality: 'maj', beat: 0, duration: 4}]},
        {id: 'rock-power', name: 'I-V (Power)', type: 'chords', genre: 'rock', key: 'C', bars: 1,
         steps: [{degree: 'I', quality: 'maj', beat: 0, duration: 2}, {degree: 'V', quality: 'maj', beat: 2, duration: 2}]},
        {id: 'blues-turnaround', name: 'Blues Turnaround', type: 'chords', genre: 'blues', key: 'C', bars: 1,
         steps: [{degree: 'I', quality: 'dom7', beat: 0, duration: 1}, {degree: 'VI', quality: 'dom7', beat: 1, duration: 1}, {degree: 'II', quality: 'min7', beat: 2, duration: 1}, {degree: 'V', quality: 'dom7', beat: 3, duration: 1}]},
        {id: 'funk-vamp', name: 'i-i (Funk Vamp)', type: 'chords', genre: 'funk', key: 'C', bars: 1,
         steps: [{degree: 'I', quality: 'min7', beat: 0, duration: 4}]}
    ];
    window.MELODIC_LINES = [
        {id: 'major-run', name: 'Major Scale Run', type: 'melody', genre: 'foundation', key: 'C', bars: 1, scale: 'major',
         steps: [{degree: 1, octave: 4, beat: 0, duration: '8n'}, {degree: 2, octave: 4, beat: 0.5, duration: '8n'}, {degree: 3, octave: 4, beat: 1, duration: '8n'}, {degree: 4, octave: 4, beat: 1.5, duration: '8n'}, {degree: 5, octave: 4, beat: 2, duration: '8n'}, {degree: 6, octave: 4, beat: 2.5, duration: '8n'}, {degree: 7, octave: 4, beat: 3, duration: '8n'}, {degree: 1, octave: 5, beat: 3.5, duration: '8n'}]}
    ];
    console.log('Patterns loaded:', window.CHORD_PROGRESSIONS.length, 'chords,', window.MELODIC_LINES.length, 'melodies');
    </script>

    <script src="js/melody-gen.js?v=8"></script>
    <script src="js/app.js"></script>
</body>
</html>
