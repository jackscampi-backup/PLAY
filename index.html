<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRUMMER - Beat Generator per Bassisti</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="rack-wrapper">

    <div class="rack-container">

    <!-- BASS Unit -->
    <div class="rack-unit rack-bassist">
        <!-- Viti angolari -->
        <div class="rack-screw top-left"></div>
        <div class="rack-screw top-right"></div>
        <div class="rack-screw bottom-left"></div>
        <div class="rack-screw bottom-right"></div>

        <!-- Header -->
        <header class="rack-header">
            <div class="header-toggles-left">
                <button class="display-toggle" id="scalePlayBtn" onclick="fretboard.togglePlay()">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ON</span>
                </button>
            </div>
            <div class="logo-display">BASS</div>
            <div class="header-toggles-right">
                <button class="display-toggle" id="globalNotationToggle">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ITA</span>
                </button>
            </div>
        </header>

        <!-- Main Panel -->
        <main class="rack-panel bassist-panel">
            <!-- Root Note Selection -->
            <section class="panel-section">
                <div class="section-label">ROOT</div>
                <div class="button-grid root-grid" id="rootButtons">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- Scale Selection -->
            <section class="panel-section">
                <div class="section-label">SCALE</div>
                <div class="button-grid scale-grid" id="scaleButtons">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- View Toggles -->
            <section class="panel-section">
                <div class="section-label">VIEW</div>
                <div class="button-grid view-grid-5">
                    <button class="display-toggle" id="arpToggle" onclick="fretboard.toggleArpeggio()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">ARP</span>
                    </button>
                    <button class="display-toggle" id="shapeToggle" onclick="fretboard.toggleShape()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">BOX</span>
                    </button>
                    <button class="display-toggle" id="displayToggle" onclick="fretboard.toggleDisplay()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">INT</span>
                    </button>
                    <button class="display-toggle" id="grooveToggle" onclick="fretboard.toggleGrooveMode()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">GROOVE</span>
                    </button>
                    <button class="display-toggle" id="melodyToggle" onclick="fretboard.toggleMelodySync()">
                        <span class="toggle-led"></span>
                        <span class="toggle-label">MEL</span>
                    </button>
                </div>
            </section>

            <!-- Grooves Selection -->
            <section class="panel-section groove-section">
                <div class="section-label">GROOVES</div>
                <div class="groove-categories" id="grooveCategories">
                    <!-- Populated by JS -->
                </div>
                <select class="audio-select groove-select-full" id="grooveSelect" onchange="fretboard.selectGroove(this.value)">
                    <option value="">-- Select --</option>
                </select>
            </section>

            <section class="panel-section mel-chord-section" id="melChordSection" style="display: none;">
                <div class="chord-strip" id="bassChordStrip">
                    <!-- Populated by JS: shows chord progression like PIANO -->
                </div>
            </section>

            <!-- Fretboard -->
            <section class="panel-section fretboard-section">
                <div id="fretboard" class="fretboard">
                    <!-- Populated by JS -->
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="rack-footer">
            <span class="footer-text">4-STRING BASS FRETBOARD</span>
        </footer>
    </div>

    <!-- DRUMMER Unit -->
    <div class="rack-unit rack-main">
        <!-- Viti angolari -->
        <div class="rack-screw top-left"></div>
        <div class="rack-screw top-right"></div>
        <div class="rack-screw bottom-left"></div>
        <div class="rack-screw bottom-right"></div>

        <!-- Header Panel -->
        <header class="rack-header">
            <div class="header-toggles-left">
                <button class="display-toggle" id="beatPlayBtn">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ON</span>
                </button>
            </div>
            <div class="logo-display">DRUMMER</div>
            <div class="header-toggles-right">
                <div class="bpm-control">
                    <button class="bpm-btn" id="bpmMinus">-</button>
                    <span class="bpm-display" id="bpmDisplay">120</span>
                    <button class="bpm-btn" id="bpmPlus">+</button>
                </div>
                <button class="display-toggle" id="autoModeBtn">
                    <span class="toggle-led auto-led"></span>
                    <span class="toggle-label">AUTO</span>
                </button>
            </div>
        </header>

        <!-- Main Panel -->
        <main class="rack-panel">

            <!-- Genre Section -->
            <section class="panel-section">
                <div class="section-label">GENRE</div>
                <div class="button-grid" id="genreButtons">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- Pattern Section -->
            <section class="panel-section">
                <div class="section-label">PATTERN</div>
                <div class="button-grid" id="variationButtons">
                    <!-- Populated by JS -->
                </div>
            </section>


            <!-- Pattern Display -->
            <section class="pattern-section">
                <div class="pattern-grid">
                    <!-- Beat Counter Row -->
                    <div class="beat-row">
                        <div class="beat-group">
                            <span class="beat-num" data-beat="1">1</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                        </div>
                        <div class="beat-group">
                            <span class="beat-num" data-beat="2">2</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                        </div>
                        <div class="beat-group">
                            <span class="beat-num" data-beat="3">3</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                        </div>
                        <div class="beat-group">
                            <span class="beat-num" data-beat="4">4</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                            <span class="beat-dot">·</span>
                        </div>
                    </div>

                    <!-- Kick Row -->
                    <div class="step-row" id="kickPattern"></div>

                    <!-- Snare Row -->
                    <div class="step-row" id="snarePattern"></div>

                    <!-- Hi-Hat Row -->
                    <div class="step-row" id="hihatPattern"></div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="rack-footer">
            <span class="footer-text">SPACE = PLAY/STOP</span>
        </footer>
    </div>

    <!-- PIANO Unit -->
    <div class="rack-unit rack-melody">
        <!-- Viti angolari -->
        <div class="rack-screw top-left"></div>
        <div class="rack-screw top-right"></div>
        <div class="rack-screw bottom-left"></div>
        <div class="rack-screw bottom-right"></div>

        <!-- Header -->
        <header class="rack-header">
            <div class="header-toggles-left">
                <button class="display-toggle" id="melodyPlayBtn">
                    <span class="toggle-led"></span>
                    <span class="toggle-label">ON</span>
                </button>
            </div>
            <div class="logo-display">PIANO</div>
            <div class="header-toggles-right">
                <div class="octave-control">
                    <button class="bpm-btn" id="melodyOctMinus">-</button>
                    <span class="octave-display" id="melodyOctDisplay">3</span>
                    <button class="bpm-btn" id="melodyOctPlus">+</button>
                </div>
            </div>
        </header>

        <!-- Main Panel -->
        <main class="rack-panel melody-panel">

            <!-- Row 1: MODE + PATTERN dropdown -->
            <section class="panel-section melody-row">
                <div class="melody-control-group">
                    <div class="section-label">MODE</div>
                    <div class="mode-toggle-compact">
                        <button class="display-toggle" id="melodyChordsBtn">
                            <span class="toggle-led"></span>
                            <span class="toggle-label">CHORDS</span>
                        </button>
                        <button class="display-toggle" id="melodyMelodyBtn">
                            <span class="toggle-led"></span>
                            <span class="toggle-label">MELODY</span>
                        </button>
                    </div>
                </div>
                <div class="melody-control-group melody-pattern-group">
                    <div class="section-label">PATTERN</div>
                    <select class="groove-select-full" id="melodyPatternSelect">
                        <option value="">-- Select --</option>
                    </select>
                </div>
            </section>

            <!-- Chord Display -->
            <section class="panel-section">
                <div class="chord-display" id="chordDisplay">
                    <div class="chord-name" id="chordName">—</div>
                    <div class="chord-notes" id="chordNotes">Select a pattern</div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="rack-footer">
            <span class="footer-text">HARMONIC ACCOMPANIMENT</span>
        </footer>
    </div>

    </div><!-- /rack-container -->

    <!-- MIXER Unit (horizontal, full width at bottom) -->
    <div class="rack-unit rack-mixer">
        <div class="rack-screw top-left"></div>
        <div class="rack-screw top-right"></div>
        <div class="rack-screw bottom-left"></div>
        <div class="rack-screw bottom-right"></div>

        <header class="rack-header">
            <div class="logo-display">MIXER</div>
        </header>

        <main class="rack-panel mixer-panel">
            <div class="mixer-channels">
                <!-- Master Channel -->
                <div class="mixer-channel master-channel">
                    <span class="channel-label">MASTER</span>
                    <input type="range" class="mixer-fader" id="masterVolume" min="0" max="100" value="80" orient="vertical">
                </div>

                <!-- Kick Channel -->
                <div class="mixer-channel">
                    <span class="channel-label">KICK</span>
                    <input type="range" class="mixer-fader" id="kickVolume" min="0" max="100" value="70" orient="vertical">
                    <select class="channel-select" id="kickType">
                        <option value="deep">Deep</option>
                        <option value="punchy">Punchy</option>
                        <option value="808">808</option>
                        <option value="acoustic">Acoustic</option>
                    </select>
                </div>

                <!-- Snare Channel -->
                <div class="mixer-channel">
                    <span class="channel-label">SNARE</span>
                    <input type="range" class="mixer-fader" id="snareVolume" min="0" max="100" value="70" orient="vertical">
                    <select class="channel-select" id="snareType">
                        <option value="tight">Tight</option>
                        <option value="fat">Fat</option>
                        <option value="rim">Rim</option>
                        <option value="clap">Clap</option>
                    </select>
                </div>

                <!-- Hi-Hat Channel -->
                <div class="mixer-channel">
                    <span class="channel-label">HI-HAT</span>
                    <input type="range" class="mixer-fader" id="hihatVolume" min="0" max="100" value="60" orient="vertical">
                    <select class="channel-select" id="hihatType">
                        <option value="closed">Closed</option>
                        <option value="open">Open</option>
                        <option value="shaker">Shaker</option>
                        <option value="ride">Ride</option>
                    </select>
                </div>

                <!-- Piano Channel -->
                <div class="mixer-channel">
                    <span class="channel-label">PIANO</span>
                    <input type="range" class="mixer-fader" id="melodyVolumeGlobal" min="0" max="100" value="70" orient="vertical">
                    <select class="channel-select" id="melodyTypeGlobal">
                        <option value="piano">Piano</option>
                        <option value="organ">Organ</option>
                        <option value="epiano">E-Piano</option>
                        <option value="synth">Synth</option>
                    </select>
                </div>

                <!-- Bass Channel -->
                <div class="mixer-channel">
                    <span class="channel-label">BASS</span>
                    <input type="range" class="mixer-fader" id="bassVolume" min="0" max="100" value="70" orient="vertical">
                    <select class="channel-select" id="bassType">
                        <option value="finger">Finger</option>
                        <option value="pick">Pick</option>
                        <option value="synth">Synth</option>
                        <option value="upright">Upright</option>
                    </select>
                </div>

                <!-- FX Channel -->
                <div class="mixer-channel fx-channel">
                    <span class="channel-label">FX</span>
                    <input type="range" class="mixer-fader" id="vinylAmount" min="0" max="100" value="0" orient="vertical">
                    <span class="fx-label">Vinyl</span>
                </div>
            </div>
        </main>
    </div>

    </div><!-- /rack-wrapper -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="js/patterns.js"></script>
    <script src="js/scales.js"></script>
    <script src="js/sounds.js"></script>
    <script src="js/riffs.js"></script>
    <script src="js/beatgen.js"></script>
    <script src="js/fretboard.js?v=2"></script>

    <script src="js/melody-gen.js?v=9"></script>
    <script src="js/app.js"></script>
</body>
</html>
